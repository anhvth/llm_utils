# Get current version from pyproject.toml using grep and sed
current_version=$(grep -E '^version\s*=\s*"[^"]+"' pyproject.toml | sed -E 's/version\s*=\s*"([^"]+)"/\1/')

# Calculate new patch version
IFS='.' read -r major minor patch <<< "$current_version"
new_patch=$((patch + 1))
new_version="$major.$minor.$new_patch"

echo "Bumping version from $current_version to $new_version"

# Update version in pyproject.toml
sed -i "s/^version = \"$current_version\"/version = \"$new_version\"/" pyproject.toml

# Check if update was successful
if grep -q "version = \"$new_version\"" pyproject.toml; then
    echo "Version updated successfully"
else
    echo "Error: Version update failed"
    exit 1
fi

# git add -A && git commit -m "Bumped version"
# git push
# git add -A && git commit -m "Bumped version"
# git push